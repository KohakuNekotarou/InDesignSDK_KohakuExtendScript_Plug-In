//========================================================================================
//  
//  $File: $
//  
//  Owner: 
//  
//  $Author: $
//  
//  $DateTime: $
//  
//  $Revision: $
//  
//  $Change: $
//  
//  Copyright 1997-2012 Adobe Systems Incorporated. All rights reserved.
//  
//  NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance 
//  with the terms of the Adobe license agreement accompanying it.  If you have received
//  this file from a source other than Adobe, then your use, modification, or 
//  distribution of it requires the prior written permission of Adobe.
//  
//========================================================================================

#include "VCPlugInHeaders.h"

// General includes:
#include "MenuDef.fh"
#include "ActionDef.fh"
#include "ActionDefs.h"
#include "AdobeMenuPositions.h"
#include "LocaleIndex.h"
#include "PMLocaleIds.h"
#include "StringTable.fh"
#include "ObjectModelTypes.fh"
#include "ShuksanID.h"
#include "ActionID.h"
#include "CommandID.h"
#include "WorkspaceID.h"
#include "WidgetID.h"
#include "BuildNumber.h"
#include "PlugInModel_UIAttributes.h"
// ---------------------------------------------------------------------------------------
#include "AppFrameworkID.h" // for kApplicationObjectScriptElement.
#include "DocFrameworkID.h" // for kDocumentObjectScriptElement.
#include "ScriptInfoTypes.fh" // for BoolType etc.
#include "TextScriptID.h" // for kParagraphStyleObjectScriptElement etc.

// Project includes:
#include "KESID.h"
#include "GenericID.h"
#include "ShuksanID.h"
#include "TextID.h"
#include "KESScriptingDefs.h"

#ifdef __ODFRC__

/*  
 * Plugin version definition.
 */
resource PluginVersion (kSDKDefPluginVersionResourceID)
{
	kTargetVersion,
	kKESPluginID,
	kSDKDefPlugInMajorVersionNumber, kSDKDefPlugInMinorVersionNumber,
	kSDKDefHostMajorVersionNumber, kSDKDefHostMinorVersionNumber,
	kKESCurrentMajorFormatNumber, kKESCurrentMinorFormatNumber,
	{ kInDesignProduct },
	{ kWildFS },
	kModelPlugIn,
	kKESVersion
};

/*  
 * The ExtraPluginInfo resource adds extra information to the Missing Plug-in dialog
 * that is popped when a document containing this plug-in's data is opened when
 * this plug-in is not present. These strings are not translatable strings
 * since they must be available when the plug-in isn't around. They get stored
 * in any document that this plug-in contributes data to.
 */
resource ExtraPluginInfo(1)
{
	kKESCompanyValue,			// Company name
	kKESMissingPluginURLValue,	// URL 
	kKESMissingPluginAlertValue,	// Missing plug-in alert text
};

/* 
 * Boss class definitions�i��`�j.
 */
resource ClassDescriptionTable(kSDKDefClassDescriptionTableResourceID)
{{{
	// ---------------------------------------------------------------------------------------
	Class
	{
		kKESPrefsScriptProviderBoss,
		kBaseScriptProviderBoss,
		{
			IID_ISCRIPTPROVIDER, kKESPrefsScriptProviderImpl,	
		}
	},

	// ---------------------------------------------------------------------------------------
	Class
	{
		kKESScriptProviderBoss,
		kBaseScriptProviderBoss,
		{
			IID_ISCRIPTPROVIDER, kKESScriptProviderImpl,
			
		}
	},

	// ---------------------------------------------------------------------------------------
	AddIn
	{
		kActiveContextBoss,
		kInvalidClass,
		{
			IID_IKESLayoutScrollObserver, kKESLayoutScrollObserverImpl,
		}
	},
}}};

/*  
 * Implementation definition.
 */
resource FactoryList (kSDKDefFactoryListResourceID)
{
	kImplementationIDSpace,
	{
		#include "KESFactoryList.h"
	}
};


/*  
 * Locale Indicies.
 * The LocaleIndex should have indicies that point at your
 * localizations for each language system that you are localized for.
 */

/*  
 * String LocaleIndex.
 */
resource LocaleIndex ( kSDKDefStringsResourceID)
{
	kStringTableRsrcType,
	{
		kWildFS, k_enUS, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_enGB, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_deDE, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_frFR, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_esES, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_ptBR, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_svSE, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_daDK, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_nlNL, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_itIT, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_nbNO, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_fiFI, kSDKDefStringsResourceID + index_enUS
		kInDesignJapaneseFS, k_jaJP, kSDKDefStringsResourceID + index_jaJP
	}
};

resource LocaleIndex (kSDKDefStringsNoTransResourceID)
{
	kStringTableRsrcType,
	{
		kWildFS, k_Wild, kSDKDefStringsNoTransResourceID + index_enUS
	}
};

// Strings not being localized
resource StringTable (kSDKDefStringsNoTransResourceID + index_enUS)
{
	k_enUS,									// Locale Id
	kEuropeanMacToWinEncodingConverter,		// Character encoding converter
	{
	}
};
/*

/*  Scripting definition
	In InDesign/InCopy, scripting resources are defined via ODFRez statements for cross-platform compatibility.
*/
resource VersionedScriptElementInfo(1) // Do not duplicate numbers.
{
	// Contexts
	{
        kFiredrakeScriptVersion, kCoreScriptManagerBoss, kInDesignAllLanguagesFS, k_Wild,
		kFiredrakeScriptVersion, kCoreScriptManagerBoss, kInCopyAllLanguagesFS, k_Wild,
	}
	
	// Elements
	{
		// ---------------------------------------------------------------------------------------
		// Split layout object
		Object
		{
			kKESSplitLayoutViewObjectScriptElement,	// Script element ID
			c_KESSplitLayoutViewObject, // ScriptID
			"split layout view object", // name
			"Split layout view Object", // description
			kCPrefs_CLSID, // Windows CLSID
			NoCollectionInfo, // CollectionElementType (scriptID, name, descr, CLSID)
			kPreferencesObjectScriptElement, // base object script element ID
			kPreferencesSuiteScriptElement,	// suite script element ID
		}

		// Enable access to the splitLayoutView object as a property.
        Property
        {
            kKESSplitLayoutViewObjectPropertyScriptElement,	// Script element ID
            p_KESSplitLayoutViewObject, // ScriptID
            "split layout view", // Access object using this name.
            "Split layout view property", // description
            ObjectType( kKESSplitLayoutViewObjectScriptElement ), // type
            {} // alternate types
            kNoAttributeClass,
        }

		Property
		{
			kKESSplitLayoutViewAccessContentLocationAtFrameOriginXPropertyScriptElement,
			p_KESSplitLayoutViewAccessContentLocationAtFrameOriginX,
			"access content location at frame origin x",
			"Access content location at frame origin X",
			RealType,
			{}
			kNoAttributeClass,
		}

		Property
		{
			kKESSplitLayoutViewAccessContentLocationAtFrameOriginYPropertyScriptElement,
			p_KESSplitLayoutViewAccessContentLocationAtFrameOriginY,
			"access content location at frame origin y",
			"Access content location at frame origin Y",
			RealType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		// Query Nth layout.
		Method
		{
			kKESQueryNthLayoutMethodScriptElement, // ScriptElementID
			e_KESQueryNthLayout, // ScriptID
			"query nth layout", // Name. If you want the name in the script to be "kohakuNekotarou", enter "kohaku nekotarou".
			"Query Nth Layout", // Description
			ObjectType(kLayoutWindowObjectScriptElement), // Return value.
			"Nth layout window",
			{ // list of method parameters.
				p_KESNthLayoutIndex, // Parameter's ScriptID.
				"index", // Parameter's name.
				"Layout window index", // Parameter's description.
				Int32Type, // Parameter's type.
				kRequired, // kOptional or kRequired�i�K�{�j.
			}
		}

		// ---------------------------------------------------------------------------------------
		// Match scroll zoom all layout.
		Method
		{
			kKESMatchScrollZoomAllLayoutMethodScriptElement, // Script Element ID	KESID.h Script Element IDs
			e_KESMatchScrollZoomAllLayout, // Script Element ID	KEScriptingDefs.h	external dependencies
			"match scroll zoom all layout", // If you want the name in the script to be "kohakuNekotarou", enter "kohaku nekotarou"
			"Match scroll zoom all layout", // Description
			VoidType, // Return value
			{ // Arguments
			}
		}

		// ---------------------------------------------------------------------------------------
		// Toggle split layout.
		Method
		{
			kKESToggleSplitLayoutMethodScriptElement,
			e_KESToggleSplitLayout,
			"toggle split layout",
			"Toggle split layout",
			VoidType,
			{
			}
		}
		// ---------------------------------------------------------------------------------------
		// Is split layout view shown
		Method
		{
			kKESIsSplitLayoutViewShownMethodScriptElement,
			e_KESIsSplitLayoutViewShown,
			"is split layout view shown",
			"Is split layout view shown",
			BoolType,
			"Is split layout view shown flg",
			{
			}
		}

		// ---------------------------------------------------------------------------------------
		//
		Property
		{
			kKESAccessContentLocationAtFrameOriginXPropertyScriptElement,
			p_KESAccessContentLocationAtFrameOriginX,
			"access content location at frame origin x",
			"Access content location at frame origin X",
			RealType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		//
		Property
		{
			kKESAccessContentLocationAtFrameOriginYPropertyScriptElement,
			p_KESAccessContentLocationAtFrameOriginY,
			"access content location at frame origin y",
			"Access content location at frame origin Y",
			RealType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		// Auto match scroll zoom all layout.
		Property
		{
			kKESAutoMatchScrollZoomAllLayoutPropertyScriptElement,
			p_KESAutoMatchScrollZoomAllLayout,
			"auto match scroll zoom all layout",
			"Auto match scroll zoom all layout",
			BoolType,
			{}
			kNoAttributeClass,
		}
		// ---------------------------------------------------------------------------------------
		Enum
		{
			kKESModifierEnumScriptElement,
			en_KESModifier,
			"kes modifier",
			"Modifier.",
			{
				en_KESNo, "no", "kNoKBSCModifier" // KesModifier.no
				en_KESControl, "control", "kControl"
				en_KESShift, "shift", "kShift"
				en_KESAltOrOption, "alt or option", "kOption"
				en_KESControlShift, "control shift", "kControlShift"
				en_KESControlAltOrOption, "control alt or option", "kControlOption"
				en_KESShiftAltOrOption, "shift alt or option", "kShiftOption"
				en_KESControlShiftAltOrOption, "control shift alt or option", "kControlShiftOption"
			}
		}

		// ---------------------------------------------------------------------------------------
		// Set keyboard shortcut for style.
		Method
		{
			kKESSetKeyboardShortcutForStyleMethodScriptElement, // ScriptElementID
			e_KESSetKeyboardShortcutForStyle, // ScriptID
			"set keyboard shortcut", // Name. If you want the name in the script to be "kohakuNekotarou", enter "kohaku nekotarou".
			"Set keyboard shortcut", // Description
			VoidType,
			{
				p_KESCKey, "key", "Key", StringType, kRequired,
				p_KESCModifier, "modifier", "Modifier", EnumType(kKESModifierEnumScriptElement), kRequired,
			}
		}

		// ---------------------------------------------------------------------------------------
		// Connects this plug-in's singleton object and methods and properties to scripting
		Provider
		{
			kKESPrefsScriptProviderBoss,	// provider boss ID
			{
				// Parent
				Parent{ kLayoutWindowObjectScriptElement },	

				// Split layout object
				RepresentObject{ kKESSplitLayoutViewObjectScriptElement }, // Additional

				// The property on the parent object returns Split layout object
				ParentProperty{ kKESSplitLayoutViewObjectPropertyScriptElement, kReadOnly }, // Additional
				
				// Access content location at frame origin.
				// ExtendScript Example:
				//     app.activeDocument.layoutWindows[0].splitLayoutView.accessContentLocationAtFrameOriginX = 0; // Set
				//     y = app.activeDocument.layoutWindows[0].splitLayoutView.accessContentLocationAtFrameOriginY; // get
				Property{ kKESSplitLayoutViewAccessContentLocationAtFrameOriginXPropertyScriptElement, kReadWrite }, // Additional
				Property{ kKESSplitLayoutViewAccessContentLocationAtFrameOriginYPropertyScriptElement, kReadWrite }, // Additiona
			}
		}

		// ---------------------------------------------------------------------------------------
		// Connects this plug-in's methods and properties to scripting.
		Provider
		{
			kKESScriptProviderBoss,	// provider boss ID
			{
				// ---------------------------------------------------------------------------------------
				// target
				Object{ kApplicationObjectScriptElement },

				// Match scroll zoom all layout. 
				// ExtendScript Example:
				//		app.matchScrollZoomAllLayout();
				Method{ kKESMatchScrollZoomAllLayoutMethodScriptElement }, // Additional

				// Auto match scroll zoom all layout. 
				// ExtendScript Example:
				//		app.autoMatchScrollZoomAllLayout = true; // Set
				//		flg = app.autoMatchScrollZoomAllLayout; // get
				Property{ kKESAutoMatchScrollZoomAllLayoutPropertyScriptElement, kReadWrite }, // Additional

				// ---------------------------------------------------------------------------------------
				// target
				Object{ kDocumentObjectScriptElement },

				// Query Nth layout. 
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0);
				Method{ kKESQueryNthLayoutMethodScriptElement }, // Additional

				// ---------------------------------------------------------------------------------------
				// target
				Object{ kLayoutWindowObjectScriptElement },

				// Toggle split layout.
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).toggleSplitLayout();
				Method{ kKESToggleSplitLayoutMethodScriptElement }, // Additional

				// Is split layout view shown.
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).isSplitLayoutViewShown();
				Method{ kKESIsSplitLayoutViewShownMethodScriptElement }, // Additional

				// Access content location at frame origin.
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).accessContentLocationAtFrameOriginX = 0; // Set
				//		y = app.activeDocument.queryNthLayout(0).accessContentLocationAtFrameOriginY; // get
				Property{ kKESAccessContentLocationAtFrameOriginXPropertyScriptElement, kReadWrite }, // Additional
				Property{ kKESAccessContentLocationAtFrameOriginYPropertyScriptElement, kReadWrite }, // Additional

				// Auto match scroll zoom all layout. 
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).autoMatchScrollZoomAllLayout = true; // Set
				//		flg = app.activeDocument.queryNthLayout(0).autoMatchScrollZoomAllLayout; // get		
				Property{ kKESAutoMatchScrollZoomAllLayoutPropertyScriptElement, kReadWrite }, // Additional

				// ---------------------------------------------------------------------------------------
				// target
				Object{ kCharacterStyleObjectScriptElement },
				Object{ kParagraphStyleObjectScriptElement },

				// Set keyboard shortcut for style.
				// ExtendScript Example:
				//		app.activeDocument.characterStyles.lastItem().setKeyboardShortcut("null", KesModifier.no);
				//		app.activeDocument.paragraphStyles.lastItem().setKeyboardShortcut("K", KesModifier.control);
				//		// Key
				//		// 		null
				//		// 		A～Z etc
				//		// 		F1～12
				//		// 		Space
				//		// 		Up
				//		// 		Down
				//		// 		Right
				//		// 		Left
				//		// 		Right
				//		// 		End
				//		// 		PageUp
				//		// 		PageDown
				//		// 		Clear
				//		// 		PadAdd
				//		// 		PadSubtract
				//		// 		PadMultiply
				//		// 		PadDivide
				//		// 		PadPeriod
				//		// 		Pad0～9
				//		// Modifier
				//		//		KesModifier.no
				//		//		KesModifier.control
				//		//		KesModifier.shift
				//		//		KesModifier.altOrOption
				//		//		KesModifier.controlShift
				//		//		KesModifier.controlAltOrOption
				//		//		KesModifier.shiftAltOrOption
				//		//		KesModifier.controlShiftAltOrOption
				Method{ kKESSetKeyboardShortcutForStyleMethodScriptElement }, // Additional
			}
		}
	}
};

#endif // __ODFRC__

#include "KES_enUS.fr"
#include "KES_jaJP.fr"
