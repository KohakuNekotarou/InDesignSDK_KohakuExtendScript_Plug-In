//========================================================================================
//  
//  $File: $
//  
//  Owner: 
//  
//  $Author: $
//  
//  $DateTime: $
//  
//  $Revision: $
//  
//  $Change: $
//  
//  Copyright 1997-2012 Adobe Systems Incorporated. All rights reserved.
//  
//  NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance 
//  with the terms of the Adobe license agreement accompanying it.  If you have received
//  this file from a source other than Adobe, then your use, modification, or 
//  distribution of it requires the prior written permission of Adobe.
//  
//========================================================================================

#include "VCPlugInHeaders.h"

// General includes:
#include "MenuDef.fh"
#include "ActionDef.fh"
#include "ActionDefs.h"
#include "AdobeMenuPositions.h"
#include "LocaleIndex.h"
#include "PMLocaleIds.h"
#include "StringTable.fh"
#include "ObjectModelTypes.fh"
#include "ShuksanID.h"
#include "ActionID.h"
#include "CommandID.h"
#include "WorkspaceID.h"
#include "WidgetID.h"
#include "BuildNumber.h"
#include "PlugInModel_UIAttributes.h"

// ---------------------------------------------------------------------------------------
#include "AppFrameworkID.h" // for kApplicationObjectScriptElement.
#include "CelStyID.h" // for kCellStyleObjectScriptElement.
#include "DocFrameworkID.h" // for kDocumentObjectScriptElement.
#include "ScriptInfoTypes.fh" // for BoolType etc.
#include "TablesID.h" // for kTableStyleObjectScriptElement.
#include "TextScriptID.h" // for kParagraphStyleObjectScriptElement etc.

// Project includes:
#include "KESID.h"
#include "GenericID.h"
#include "ShuksanID.h"
#include "TextID.h"
#include "KESScriptingDefs.h"

#ifdef __ODFRC__

/*  
 * Plugin version definition.
 */
resource PluginVersion (kSDKDefPluginVersionResourceID)
{
	kTargetVersion,
	kKESPluginID,
	kSDKDefPlugInMajorVersionNumber, kSDKDefPlugInMinorVersionNumber,
	kSDKDefHostMajorVersionNumber, kSDKDefHostMinorVersionNumber,
	kKESCurrentMajorFormatNumber, kKESCurrentMinorFormatNumber,
	{ kInDesignProduct },
	{ kWildFS },
	kModelPlugIn,
	kKESVersion
};

/*  
 * The ExtraPluginInfo resource adds extra information to the Missing Plug-in dialog
 * that is popped when a document containing this plug-in's data is opened when
 * this plug-in is not present. These strings are not translatable strings
 * since they must be available when the plug-in isn't around. They get stored
 * in any document that this plug-in contributes data to.
 */
resource ExtraPluginInfo(1)
{
	kKESCompanyValue,			// Company name
	kKESMissingPluginURLValue,	// URL 
	kKESMissingPluginAlertValue,	// Missing plug-in alert text
};

/* 
 * Boss class definitions�i��`�j.
 */
resource ClassDescriptionTable(kSDKDefClassDescriptionTableResourceID)
{{{
	
	// Script provider
	Class
	{
		kKESScriptProviderBoss,
		kBaseScriptProviderBoss,
		{
			IID_ISCRIPTPROVIDER, kKESScriptProviderImpl,
		}
	},

	// Represent script provider
	Class
	{
		kKESRepresentScriptProviderBoss,
		kBaseScriptProviderBoss,
		{
			IID_ISCRIPTPROVIDER, kKESRepresentScriptProviderImpl,
		}
	},

	// Shortcut script
	Class
	{
		kKESShortcutScriptObjectBoss,
		kBaseProxyScriptObjectBoss,
		{
			IID_ISCRIPT, kKESShortcutScriptImpl,	
		}
	},

	// ---------------------------------------------------------------------------------------
	AddIn
	{
		kActiveContextBoss,
		kInvalidClass,
		{
			IID_IKESLayoutScrollObserver, kKESLayoutScrollObserverImpl,
		}
	},
}}};

/*  
 * Implementation definition.
 */
resource FactoryList (kSDKDefFactoryListResourceID)
{
	kImplementationIDSpace,
	{
		#include "KESFactoryList.h"
	}
};


/*  
 * Locale Indicies.
 * The LocaleIndex should have indicies that point at your
 * localizations for each language system that you are localized for.
 */

/*  
 * String LocaleIndex.
 */
resource LocaleIndex ( kSDKDefStringsResourceID)
{
	kStringTableRsrcType,
	{
		kWildFS, k_enUS, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_enGB, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_deDE, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_frFR, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_esES, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_ptBR, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_svSE, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_daDK, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_nlNL, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_itIT, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_nbNO, kSDKDefStringsResourceID + index_enUS
		kWildFS, k_fiFI, kSDKDefStringsResourceID + index_enUS
		kInDesignJapaneseFS, k_jaJP, kSDKDefStringsResourceID + index_jaJP
	}
};

resource LocaleIndex (kSDKDefStringsNoTransResourceID)
{
	kStringTableRsrcType,
	{
		kWildFS, k_Wild, kSDKDefStringsNoTransResourceID + index_enUS
	}
};

// Strings not being localized
resource StringTable (kSDKDefStringsNoTransResourceID + index_enUS)
{
	k_enUS,									// Locale Id
	kEuropeanMacToWinEncodingConverter,		// Character encoding converter
	{
	}
};
/*

/*  Scripting definition
	In InDesign/InCopy, scripting resources are defined via ODFRez statements for cross-platform compatibility.
*/
resource VersionedScriptElementInfo(1) // Do not duplicate numbers.
{
	// Contexts
	{
        kFiredrakeScriptVersion, kCoreScriptManagerBoss, kInDesignAllLanguagesFS, k_Wild,
		kFiredrakeScriptVersion, kCoreScriptManagerBoss, kInCopyAllLanguagesFS, k_Wild,
	}
	
	// Elements
	{
		// ---------------------------------------------------------------------------------------
		// Shortcut object
		Object
		{
			kKESShortcutObjectScriptElement, // Script element ID
			c_KESShortcutObject, // ScriptID
			"shortcut", // Name
			"Shortcut", // Description
			kKESShortcutObject_CLSID, // Windows CLSID
			c_KESShortcutsObject, // Collection
			"shortcuts", // Name
			"All shortcut", // Description
			kKESShortcutsObject_CLSID, // Windows CLSID
			kNonIDBasedObjectScriptElement, // base object script element ID
			kBasicSuiteScriptElement,	// suite script element ID
		}

		// ---------------------------------------------------------------------------------------
		// Query Nth layout.
		Method
		{
			kKESQueryNthLayoutMethodScriptElement, // ScriptElementID
			e_KESQueryNthLayout, // ScriptID
			"query nth layout", // Name. If you want the name in the script to be "kohakuNekotarou", enter "kohaku nekotarou".
			"Query Nth Layout", // Description
			ObjectType(kLayoutWindowObjectScriptElement), // Return value.
			"Nth layout window",
			{ // list of method parameters.
				p_KESNthLayoutIndex, // Parameter's ScriptID.
				"index", // Parameter's name.
				"Layout window index", // Parameter's description.
				Int32Type, // Parameter's type.
				kRequired, // kOptional or kRequired�i�K�{�j.
			}
		}

		// ---------------------------------------------------------------------------------------
		// Match scroll zoom all layout.
		Method
		{
			kKESMatchScrollZoomAllLayoutMethodScriptElement, // Script Element ID	KESID.h Script Element IDs
			e_KESMatchScrollZoomAllLayout, // Script Element ID	KEScriptingDefs.h	external dependencies
			"match scroll zoom all layout", // If you want the name in the script to be "kohakuNekotarou", enter "kohaku nekotarou"
			"Match scroll zoom all layout", // Description
			VoidType, // Return value
			{ // Arguments
			}
		}

		// ---------------------------------------------------------------------------------------
		// Toggle split layout.
		Method
		{
			kKESToggleSplitLayoutMethodScriptElement,
			e_KESToggleSplitLayout,
			"toggle split layout",
			"Toggle split layout",
			VoidType,
			{
			}
		}

		// ---------------------------------------------------------------------------------------
		// Is split layout view shown
		Method
		{
			kKESIsSplitLayoutViewShownMethodScriptElement,
			e_KESIsSplitLayoutViewShown,
			"is split layout view shown",
			"Is split layout view shown",
			BoolType,
			"Is split layout view shown flg",
			{
			}
		}

		// ---------------------------------------------------------------------------------------
		//
		Property
		{
			kKESAccessContentLocationAtFrameOriginXPropertyScriptElement,
			p_KESAccessContentLocationAtFrameOriginX,
			"access content location at frame origin x",
			"Access content location at frame origin X",
			RealType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		//
		Property
		{
			kKESAccessContentLocationAtFrameOriginYPropertyScriptElement,
			p_KESAccessContentLocationAtFrameOriginY,
			"access content location at frame origin y",
			"Access content location at frame origin Y",
			RealType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		// Auto match scroll zoom all layout.
		Property
		{
			kKESAutoMatchScrollZoomAllLayoutPropertyScriptElement,
			p_KESAutoMatchScrollZoomAllLayout,
			"auto match scroll zoom all layout",
			"Auto match scroll zoom all layout",
			BoolType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		// Keyboard shortcut for style.
		Property
		{
			kKESKeyboardShortcutForStylePropertyScriptElement,
			p_KESKeyboardShortcutForStyle,
			"keyboard shortcut",
			"Keyboard shortcut",
			StringType,
			{}
			kNoAttributeClass,
		}

		// ---------------------------------------------------------------------------------------
		// Remove context shortcut method.
		Method
		{
			kKESRemoveContextShortcutMethodScriptElement, // ScriptElementID
			e_KESRemoveContextShortcut, // ScriptID
			"remove context shortcut", // Name. If you want the name in the script to be "kohakuNekotarou", enter "kohaku nekotarou".
			"Remove context shortcut", // Description
			VoidType,
			{ // list of method parameters.
				p_KESRemoveContextShortcutContextString, // Parameter's ScriptID.
				"context string", // Parameter's name.
				"Context string", // Parameter's description.
				StringType, // Parameter's type.
				kRequired, // kOptional or kRequired.
				p_KESRemoveContextShortcutString, // Parameter's ScriptID.
				"shortcut string", // Parameter's name.
				"Shortcut string", // Parameter's description.
				StringType, // Parameter's type.
				kRequired, // kOptional or kRequired.
			}
		}

		// ---------------------------------------------------------------------------------------
		// Represent script provider
		// Subclass this to expose a new script object to the scripting.
		Provider
		{
			kKESRepresentScriptProviderBoss, // provider boss ID
			{
				// ---------------------------------------------------------------------------------------
				Parent{ kMenuActionObjectScriptElement }, // Parent

				// Shortcut object.
				RepresentObject{ kKESShortcutObjectScriptElement }, // Additional
			}
		}

		// ---------------------------------------------------------------------------------------
		// Connects this plug-in's methods and properties to scripting.
		Provider
		{
			kKESScriptProviderBoss,	// provider boss ID
			{
				// ---------------------------------------------------------------------------------------
				// target
				Object{ kApplicationObjectScriptElement },

				// Match scroll zoom all layout. 
				// ExtendScript Example:
				//		app.matchScrollZoomAllLayout();
				Method{ kKESMatchScrollZoomAllLayoutMethodScriptElement }, // Additional

				// Auto match scroll zoom all layout. 
				// ExtendScript Example:
				//		app.autoMatchScrollZoomAllLayout = true; // Set
				//		flg = app.autoMatchScrollZoomAllLayout; // get
				Property{ kKESAutoMatchScrollZoomAllLayoutPropertyScriptElement, kReadWrite }, // Additional

				// Remove context shortcut.
				// ExtendScript Example:
				//		// Contextstring:
				//		// 		DialogContext
				// 		// 		DefaultContext
				// 		// 		TableContext
				// 		// 		TableObjectContext
				// 		// 		KBSCContext_XMLStructureContext
				// 		// 		FullScreenContext
				// 		// 		TextContext
				//		app.removeContextShortcut("DefaultContext", 'Shift+Ctrl+Alt+F12'); // Style shortcuts will not disappear.
				Method{ kKESRemoveContextShortcutMethodScriptElement }, // Additional

				// Display all ActionID.
				// ExtendScript Example:
				//		app.displayAllActionID();
				//Method{ kKESDisplayAllActionIDMethodScriptElement }, // Additional

				// ---------------------------------------------------------------------------------------
				// target
				Object{ kDocumentObjectScriptElement },

				// Query Nth layout. 
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0);
				Method{ kKESQueryNthLayoutMethodScriptElement }, // Additional

				// ---------------------------------------------------------------------------------------
				// target
				Object{ kLayoutWindowObjectScriptElement },

				// Toggle split layout.
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).toggleSplitLayout();
				Method{ kKESToggleSplitLayoutMethodScriptElement }, // Additional

				// Is split layout view shown.
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).isSplitLayoutViewShown();
				Method{ kKESIsSplitLayoutViewShownMethodScriptElement }, // Additional

				// Access content location at frame origin.
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).accessContentLocationAtFrameOriginX = 0; // Set
				//		y = app.activeDocument.queryNthLayout(0).accessContentLocationAtFrameOriginY; // get
				Property{ kKESAccessContentLocationAtFrameOriginXPropertyScriptElement, kReadWrite }, // Additional
				Property{ kKESAccessContentLocationAtFrameOriginYPropertyScriptElement, kReadWrite }, // Additional

				// Auto match scroll zoom all layout. 
				// ExtendScript Example:
				//		app.activeDocument.queryNthLayout(0).autoMatchScrollZoomAllLayout = true; // Set
				//		flg = app.activeDocument.queryNthLayout(0).autoMatchScrollZoomAllLayout; // get		
				Property{ kKESAutoMatchScrollZoomAllLayoutPropertyScriptElement, kReadWrite }, // Additional

				// ---------------------------------------------------------------------------------------
				// target
				Object{ kObjectStylesObjectScriptElement },
				Object{ kTableStyleObjectScriptElement },
				Object{ kCellStyleObjectScriptElement },
				Object{ kCharacterStyleObjectScriptElement },
				Object{ kParagraphStyleObjectScriptElement },

				// keyboard shortcut for style.
				// ExtendScript Example:
				//		app.activeDocument.characterStyles.lastItem().keyboardShortcut = ""; // delete
				//		app.activeDocument.characterStyles.lastItem().keyboardShortcut = "Shift+Ctrl+Alt+Num 0"
				// 		shortcut = app.activeDocument.characterStyles.lastItem().keyboardShortcut;
				Property{ kKESKeyboardShortcutForStylePropertyScriptElement, kReadWrite }, // Additional
			}
		}
	}
};

#endif // __ODFRC__

#include "KES_enUS.fr"
#include "KES_jaJP.fr"
